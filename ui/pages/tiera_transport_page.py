# ui/pages/tiera_transport_page.py
"""
Tieraæ§˜å°‚ç”¨ã®é…é€ä¾¿è¨ˆç”»ãƒšãƒ¼ã‚¸

ã€ç‰¹å¾´ã€‘
- TransportPageã®å…¨æ©Ÿèƒ½ã‚’ç¶™æ‰¿
- Tieraæ§˜å°‚ç”¨ã®èª¬æ˜ã‚’è¿½åŠ 
- ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ­ã‚¸ãƒƒã‚¯ï¼ˆTieraTransportPlannerä½¿ç”¨ï¼‰
"""

import streamlit as st
from ui.pages.transport_page import TransportPage


class TieraTransportPage(TransportPage):
    """Tieraæ§˜å°‚ç”¨é…é€ä¾¿è¨ˆç”»ãƒšãƒ¼ã‚¸"""

    def __init__(self, transport_service, auth_service=None):
        # è¦ªã‚¯ãƒ©ã‚¹ã®åˆæœŸåŒ–ï¼ˆå…¨æ©Ÿèƒ½ã‚’ç¶™æ‰¿ï¼‰
        super().__init__(transport_service, auth_service)

    def show(self):
        """ãƒšãƒ¼ã‚¸è¡¨ç¤ºï¼ˆTieraæ§˜å°‚ç”¨ã®èª¬æ˜ã‚’è¿½åŠ ï¼‰"""
        st.title("ğŸš› é…é€ä¾¿è¨ˆç”»ï¼ˆTieraæ§˜å°‚ç”¨ï¼‰")

        # âœ… Tieraæ§˜ã®ç‰¹å¾´ã‚’èª¬æ˜
        with st.expander("ğŸ“‹ Tieraæ§˜ã®ç©è¼‰è¨ˆç”»ã®ç‰¹å¾´", expanded=False):
            st.info("""
            **âœ¨ Tieraæ§˜å°‚ç”¨ã®ç©è¼‰ãƒ«ãƒ¼ãƒ«:**

            ğŸ”¹ **ãƒªãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ **: è£½å“ã”ã¨ã«è¨­å®šï¼ˆé€šå¸¸2æ—¥ï¼‰
            - ç´å“æ—¥ã®2æ—¥å‰ã«ç©è¼‰ï¼ˆä¾‹: 10/25ç´å“ â†’ 10/23ç©è¼‰ï¼‰
            - è£½å“ãƒã‚¹ã‚¿ã®`lead_time_days`åˆ—ã§ç®¡ç†

            ğŸ”¹ **ãƒˆãƒ©ãƒƒã‚¯å„ªå…ˆé †ä½**: å¤•ä¾¿å„ªå…ˆ
            - `arrival_day_offset=1`ï¼ˆç¿Œæ—¥ç€ï¼‰ã®ãƒˆãƒ©ãƒƒã‚¯ã‚’å„ªå…ˆä½¿ç”¨
            - æœä¾¿ã¯å¤•ä¾¿ã§ç©ã‚ãªã„å ´åˆã®ã¿ä½¿ç”¨

            ğŸ”¹ **ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ­ã‚¸ãƒƒã‚¯**:
            - âœ… å‰å€’ã—ç„¡ã—ï¼ˆãƒªãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ å³å®ˆï¼‰
            - âœ… ç‰¹ä¾¿ç„¡ã—
            - âœ… ç©ã‚ã‚‹ã ã‘ç©ã‚€æ–¹å¼

            ---

            **âš™ï¸ è¨­å®šç¢ºèª:**
            - è£½å“ãƒã‚¹ã‚¿: `lead_time_days = 2`
            - ãƒˆãƒ©ãƒƒã‚¯ãƒã‚¹ã‚¿: å¤•ä¾¿ã¯`arrival_day_offset = 1`
            """)

        # æ¨©é™ãƒã‚§ãƒƒã‚¯
        can_edit = self._can_edit_page()
        if not can_edit:
            st.warning("âš ï¸ ã“ã®ç”»é¢ã®ç·¨é›†æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚é–²è¦§ã®ã¿å¯èƒ½ã§ã™ã€‚")

        # âœ… è¦ªã‚¯ãƒ©ã‚¹ã®ã‚¿ãƒ–è¡¨ç¤ºã‚’ãã®ã¾ã¾ä½¿ç”¨
        tab1, tab2, tab3, tab4, tab5 = st.tabs([
            "ğŸ“‹ ç©è¼‰è¨ˆç”»ä½œæˆ",
            "ğŸ“Š è¨ˆç”»ä¸€è¦§",
            "ğŸ” æ¤œæŸ»å¯¾è±¡è£½å“",
            "ğŸ“¦ å®¹å™¨ç®¡ç†",
            "ğŸš› ãƒˆãƒ©ãƒƒã‚¯ç®¡ç†"
        ])

        with tab1:
            # Tieraæ§˜å°‚ç”¨ã®èª¬æ˜ã‚’è¿½åŠ ã—ã¦ã‹ã‚‰è¦ªã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—
            self._show_tiera_loading_planning(can_edit)

        with tab2:
            # è¦ªã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãã®ã¾ã¾ä½¿ç”¨
            self._show_plan_view()

        with tab3:
            # è¦ªã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãã®ã¾ã¾ä½¿ç”¨
            self._show_inspection_products()

        with tab4:
            # è¦ªã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãã®ã¾ã¾ä½¿ç”¨
            self._show_container_management()

        with tab5:
            # è¦ªã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãã®ã¾ã¾ä½¿ç”¨
            self._show_truck_management()

    def _show_tiera_loading_planning(self, can_edit):
        """Tieraæ§˜ç”¨ã®ç©è¼‰è¨ˆç”»ä½œæˆï¼ˆè¦ªã‚¯ãƒ©ã‚¹ã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ï¼‰"""

        # Tieraæ§˜å°‚ç”¨ã®ãƒ’ãƒ³ãƒˆè¡¨ç¤º
        st.info("""
        ğŸ’¡ **Tieraæ§˜ã®è¨ˆç”»ä½œæˆã®ãƒã‚¤ãƒ³ãƒˆ:**
        - ãƒªãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ ã¯å„è£½å“ã®è¨­å®šå€¤ã‚’ä½¿ç”¨ï¼ˆé€šå¸¸2æ—¥ï¼‰
        - å¤•ä¾¿ï¼ˆarrival_day_offset=1ï¼‰ãŒå„ªå…ˆçš„ã«é¸ã°ã‚Œã¾ã™
        - å‰å€’ã—ã‚„ç‰¹ä¾¿ã¯å®Ÿæ–½ã•ã‚Œã¾ã›ã‚“
        """)

        # è¦ªã‚¯ãƒ©ã‚¹ã®ç©è¼‰è¨ˆç”»ä½œæˆãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—
        self._show_loading_planning()
